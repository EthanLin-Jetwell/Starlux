global class Schedule_Download_Excel implements Schedulable{
    public Integer reportNumber {get; set;}
    
    global Schedule_Download_Excel(Integer reportNumber) {
        this.reportNumber = reportNumber;
    }
    
    global void execute(SchedulableContext sc) {
        Id objId;
        Blob excelData;
        if(reportNumber == 0) {
            Agency_Report_Attachment__c agencyReportAttachment = new Agency_Report_Attachment__c();
            agencyReportAttachment.Name = Generate_Waypoint_Report_Controller.GetFileName();
            Insert agencyReportAttachment;
            objId = agencyReportAttachment.Id;
            
            PageReference generateExl = Page.Generate_Waypoint_Report;
            generateExl.getParameters().put('Id', objId);
            excelData = generateExl.getContent();
            Attachment attach = new Attachment();
            attach.ParentId = objId;
            attach.Name = Generate_Waypoint_Report_Controller.GetFileName() + '.xls';
            attach.body=excelData;
            Insert attach;
        } else if(reportNumber == 1) {
            Agency_Report_Attachment__c agencyReportAttachment = new Agency_Report_Attachment__c();
            agencyReportAttachment.Name = Generate_Agency_Report_Controller_TPE.GetFileName();
            Insert agencyReportAttachment;
            objId = agencyReportAttachment.Id;
            
            PageReference generateExl = Page.Generate_Agency_Report_TPE;
            generateExl.getParameters().put('Id', objId);
            excelData = generateExl.getContent();
            Attachment attach = new Attachment();
            attach.ParentId = objId;
            attach.Name = Generate_Agency_Report_Controller_TPE.GetFileName() + '.xls';
            attach.body=excelData;
            Insert attach;
        } else if(reportNumber == 2) {
            Agency_Report_Attachment__c agencyReportAttachment = new Agency_Report_Attachment__c();
            agencyReportAttachment.Name = Generate_Agency_Report_Controller_RMQ.GetFileName();
            Insert agencyReportAttachment;
            objId = agencyReportAttachment.Id;
            
            PageReference generateExl = Page.Generate_Agency_Report_RMQ;
            generateExl.getParameters().put('Id', objId);
            excelData = generateExl.getContent();
            Attachment attach = new Attachment();
            attach.ParentId = objId;
            attach.Name = Generate_Agency_Report_Controller_RMQ.GetFileName() + '.xls';
            attach.body=excelData;
            Insert attach;
        }
        
    }
    
    global static void fakeMethod() {
        Boolean b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
        b = true;
    }
}