<apex:page controller="ExternalTicketHomeController" action="{!ensureAuth}" docType="html-5.0" applyHtmlTag="true" standardStylesheets="false" showHeader="false">
  <head>
    <title>H1 - Home</title>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>

    <style>
    body{ background:#E9ECEF; }
    .shell{
		width: 96%;
		margin: 20px auto;
		max-width: 1400px;
    }

    .header{
		display:flex; justify-content:flex-end; align-items:center; gap:14px;
		margin-bottom:16px;
    }
    .btn{ background:#2F3B52; color:#fff; border-radius:999px; padding:.45rem .9rem; font-weight:700; letter-spacing:.3px; font-size:14px; box-shadow: 0 2px 6px rgba(0,0,0,.08); }
    .badge-dept{ background:#FFF; color:#2F3B52;text-shadow: 0.2px 0 0 currentColor, -0.2px 0 0 currentColor;  border:none; border-radius:999px; padding:.45rem 1.1rem; font-weight:700; font-size:14px; box-shadow: 0 2px 6px rgba(0,0,0,.08); }  

	.canvas{
  		background:#fff;
  		border-radius:12px;
  		padding:48px 40px;               /* ↑ 原本 36px 28px */
  		min-height: calc(100vh - 160px); /* ↑ 撐滿螢幕高度減掉 header/邊距 */
  		box-shadow:0 2px 10px rgba(0,0,0,.06);
	}

    .grid-wrap{ padding: 20px 12px 40px; }
        
    @media (max-width: 991px){
        .header{ justify-content:space-between; }
        .grid-wrap{ padding:10px; }
        }

    .card-portal {
      	display: flex;
      	flex-direction: column;
      	align-items: center;    /* 水平置中 */
      	justify-content: center;/* 垂直置中（如果高度允許） */
      	text-align: center;     /* 文字置中 */
      	gap: 16px;
      	margin-top: 9vh;
    }
        
    .card-portal .title{
      	color:#2F3B52;
      	font-weight:700;
      	font-size: clamp(20px, 2.2vw, 24px);  /* ↑ 放大標題 */
      	margin-bottom:6px;
    }
    .card-portal img{
      	width: clamp(400px, 38vw, 400px); /* ↑ 原本 360px */
      	max-width:100%;
      	height:auto;
      	cursor:pointer;
      	border-radius:12px;
      	transition: transform .15s ease-in-out, box-shadow .15s ease-in-out;
      	box-shadow: 0 2px 10px rgba(0,0,0,.05);
    }
    .card-portal img:hover{ transform: translateY(-2px); box-shadow: 0 6px 16px rgba(0,0,0,.10); }

    .notification-panel {
      	position: relative;          /* 讓叉叉可以絕對定位 */
      	display: flex;
      	justify-content: center;     /* 內容（文字）置中 */
      	align-items: center;
      	font-weight: bold;
      	font-size: 16px;
      	border-radius: 6px;
      	box-sizing: border-box;
      	padding: 14px 48px 14px 24px; /* 右邊多留空，給叉叉用 */
      	min-width: 450px;
      	margin: 12px auto;
    }
    
    .success-notification {
      	background-color: #73AB5D;
      	color: #fff;
    }
    
    .slds-notify__close {
      	position: absolute;
      	right: 16px;                  /* 固定在右邊 */
      	top: 50%;
      	transform: translateY(-50%);
      	appearance: none;
      	background: transparent;
      	border: 0;
      	color: inherit;
      	font-weight: 800;
      	font-size: 18px;
      	line-height: 1;
      	cursor: pointer;
      	opacity: .9;
    }
    .slds-notify__close:hover { opacity: 1; }
    
    .notify-wrap {
      	position: fixed;
      	top: 26px;
      	left: 50%;
      	transform: translateX(-50%);
      	z-index: 1080;
      	padding: 0 16px;
    } 
        
    .btn:hover {
      background: #2F3B52 ; /* 淺灰藍 */
      color: #fff;
    }
    
    .btn:active {
      background: #7F8FA9; /* 更淺灰藍 */
      color: #fff;
    }
    </style>
  </head>

  <body>
<!-- 置頂置中通知 -->
<div class="notify-wrap">
  <div id="loginSuccessNotification" class="notification-panel success-notification" style="display:none;">
    <span>Login Successfully</span>
    <button type="button" class="slds-notify__close" onclick="this.parentElement.style.display='none';">×</button>
  </div>
</div>

    <div class="shell">

      <!-- Header：右上角 -->
      <div class="header">
        <span class="badge-dept">{!IF(NOT(ISBLANK(departmentCode)), departmentCode, '—')}</span>
        <apex:form >
          <apex:commandButton value="LOG OUT" action="{!logout}" styleClass="btn"/>
        </apex:form>
      </div>

      <!-- 白色內容區 -->
      <div class="canvas">
        <div class="grid-wrap">
          <div class="row justify-content-center g-5">
            <!-- 左：Quota Statistics -->
            <div class="col-md-6 d-flex justify-content-center">
              <div class="card-portal">
                <div class="title">Quota Statistics</div>
                  <a href="{!URLFOR($Page.ExternalTicketQuotaStatistics)}">
                  	<img src="{!URLFOR($Resource.ExternalTicket_QuotaStatistics)}" alt="Quota Statistics"/>
                  </a>
              </div>
            </div>

            <!-- 右：Search -->
            <div class="col-md-6 d-flex justify-content-center">
              <div class="card-portal">
                <div class="title">Free &amp; Reduced Fare Tickets Search</div>
                  <a href="{!URLFOR($Page.ExternalTicketFRFTSearch)}">
                  	<img src="{!URLFOR($Resource.ExternalTicket_Search)}" alt="Free &amp; Reduced Fare Tickets Search"/>
                  </a>
              </div>
            </div>
          </div>
        </div>
      </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
<script>
function getUrlParameter(name){
  name = name.replace(/[\[]/,'\\[').replace(/[\]]/,'\\]');
  var regex = new RegExp('[\\?&]'+name+'=([^&#]*)');
  var results = regex.exec(location.search);
  return results === null ? '' : decodeURIComponent(results[1].replace(/\+/g,' '));
}

document.addEventListener('DOMContentLoaded', function(){
  var toastParam = getUrlParameter('toast');
  if (toastParam === 'login') {
    var el = document.getElementById('loginSuccessNotification');
    if (el) el.style.display = 'inline-flex';
  }
});
      
document.addEventListener('DOMContentLoaded', function(){
  var el = document.getElementById('loginSuccessNotification');
  var toastParam = getUrlParameter('toast');
  if (toastParam === 'login' && el) {
    el.style.display = 'flex';

    // 點擊任何地方關閉
    document.addEventListener('click', function hideToast(e) {
      if (!el.contains(e.target)) {
        el.style.display = 'none';
        document.removeEventListener('click', hideToast); // 關閉監聽
      }
    });
  }
});
      
</script>

  </body>
</apex:page>